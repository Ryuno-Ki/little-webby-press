{
  "version": 3,
  "file": "bundle.css",
  "sources": [
    "../../Press.svelte"
  ],
  "sourcesContent": [
    "<script>\n\timport Tabs from \"./Tabs.svelte\"\n\timport TabsActions from \"./TabsActions.svelte\"\n\timport { getFilesFromDataTransferItems } from \"datatransfer-files-promise\"\n\timport { onMount } from \"svelte\"\n\timport { bookFromFiles } from \"./book.js\"\n\timport { generateEpub } from \"./epub.js\"\n\timport { generateSite } from \"./site.js\"\n\timport { _ } from \"svelte-i18n\"\n\timport { ebookEpub3Generating, staticSiteGenerating} from \"./stores.js\"\n\n\tlet stage = \"waiting\" // loading, loaded, over\n\tlet msg, files, book\n\n\t// function readFile(file) {\n\t// \treturn new Promise((resolve, _reject) => {\n\t// \t\tvar fr = new FileReader()\n\t// \t\tfr.onload = () => {\n\t// \t\t\tresolve(fr.result)\n\t// \t\t}\n\t// \t\tfr.readAsText(file.blob)\n\t// \t})\n\t// }\n\n\tconst actionGenerateBook = (_ev) => {\n\t\tgenerateEpub(book)\n\t\t\t.catch((n) => {\n\t\t\t\tebookEpub3Generating.set(false)\n\t\t\t\tstage = \"error\"\n\t\t\t\tmsg = $_(n.message)\n\t\t\t\tconsole.error(\"error generating epub3\", n)\n\t\t\t})\n\t}\n\n\tconst actionGenerateSite = (_ev) => {\n\t\tgenerateSite(book)\n\t\t\t.catch((n) => {\n\t\t\t\tstaticSiteGenerating.set(false)\n\t\t\t\tstage = \"error\"\n\t\t\t\tmsg = $_(n.message)\n\t\t\t\tconsole.error(\"error generating site\", n)\n\t\t\t})\n\t}\n\n\tconst loadFiles = (_evt) => {\n\t\tdocument.getElementById(\"file-input\").click()\n\t}\n\n\tconst filesLoaded = async (evt) => {\n\t\tevt.preventDefault()\n\n\t\tmsg = $_(\"getting-file-list\")\n\t\tstage = \"loading\"\n\t\tfiles = Array.from(evt.target.files)\n\t\t// FileList does not contain \"filepath\" property like DataTransferItem do.\n\t\t// That property is used by book.js.\n\t\t// It's value is apparently the same as name.\n\t\tfiles = files.map(i => {\n\t\t\ti.filepath = i.webkitRelativePath\n\t\t\treturn i\n\t\t})\n\n\t\tmsg = $_(\"loading-configuration\")\n\t\tbook = await bookFromFiles(files)\n\t\tif (book instanceof Error) {\n\t\t\tstage = \"error\"\n\t\t\tmsg = $_(book.message)\n\t\t} else {\n\t\t\tstage = \"loaded\"\n\t\t}\n\t}\n\n\tonMount(() => {\n\t\tconst dropzone = document.querySelector(\".drop-area\")\n\t\tdropzone.addEventListener(\"dragover\", (evt) => {\n\t\t\tevt.preventDefault()\n\t\t\tstage = \"over\"\n\t\t})\n\t\tdropzone.addEventListener(\"dragleave\", (evt) => {\n\t\t\tevt.preventDefault()\n\t\t\tstage = \"waiting\"\n\t\t})\n\t\tdropzone.addEventListener(\"drop\", async (evt) => {\n\t\t\tevt.preventDefault()\n\n\t\t\tmsg = $_(\"getting-file-list\")\n\t\t\tstage = \"loading\"\n\t\t\tfiles = await window.getFilesFromDataTransferItems(evt.dataTransfer.items)\n\t\t\tconsole.log(\"files\", files)\n\n\t\t\tmsg = $_(\"loading-configuration\")\n\t\t\tbook = await bookFromFiles(files)\n\t\t\tif (book instanceof Error) {\n\t\t\t\tstage = \"error\"\n\t\t\t\tmsg = $_(book.message)\n\t\t\t} else {\n\t\t\t\tstage = \"loaded\"\n\t\t\t}\n\t\t})\n\t})\n</script>\n\n<style>\n\t.over {\n\t\tborder: solid 4px #e3f2fd;\n\t}\n\n\t.full-height {\n\t\theight: calc(100vh - 48px);\n\t}\n</style>\n\n<div class=\"container p-0 mx-auto full-height\">\n\t{#if stage === \"error\"}\n\t\t<div\n\t\t\tclass=\"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded\n\t\t\trelative\"\n\t\t\trole=\"alert\">\n\t\t\t<strong class=\"font-bold\">{$_(\"error-quip\")}</strong>\n\t\t\t<span class=\"block sm:inline\">{msg}</span>\n\t\t\t<span class=\"absolute top-0 bottom-0 right-0 px-4 py-3\">\n\t\t\t\t<svg\n\t\t\t\t\tclass=\"fill-current h-6 w-6 text-red-500\"\n\t\t\t\t\trole=\"button\"\n\t\t\t\t\txmlns=\"http://www.w3.org/2000/svg\"\n\t\t\t\t\tviewBox=\"0 0 20 20\">\n\t\t\t\t\t<title>{$_(\"close\")}</title>\n\t\t\t\t\t<path\n\t\t\t\t\t\td=\"M14.348 14.849a1.2 1.2 0 0 1-1.697 0L10 11.819l-2.651 3.029a1.2\n\t\t\t\t\t\t1.2 0 1 1-1.697-1.697l2.758-3.15-2.759-3.152a1.2 1.2 0 1 1\n\t\t\t\t\t\t1.697-1.697L10 8.183l2.651-3.031a1.2 1.2 0 1 1 1.697 1.697l-2.758\n\t\t\t\t\t\t3.152 2.758 3.15a1.2 1.2 0 0 1 0 1.698z\" />\n\t\t\t\t</svg>\n\t\t\t</span>\n\t\t</div>\n\t\t<div\n\t\t\tclass=\"flex justify-center content-center h-100 text-center py-3\"\n\t\t\tclass:over={stage == \"over\"}>\n\t\t\t<div>\n\t\t\t\t<div class=\"empty-icon\">\n\t\t\t\t\t<i class=\"fas fa-book fa-3x\" />\n\t\t\t\t</div>\n\t\t\t\t<p class=\"text-xl\">{$_(\"no_book\")}</p>\n\t\t\t\t<p class=\"text-light\">{$_(\"drag-and-drop-to-start\")}</p>\n\t\t\t\t<div class=\"mt-6\">\n\t\t\t\t\t<a class=\"btn btn-blue\" href=\"/help\">\n\t\t\t\t\t\t{@html $_(\"learn-more-long\")}\n\t\t\t\t\t</a>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t{/if}\n\t{#if stage !== \"loaded\"}\n\t\t<div\n\t\t\tclass=\"flex justify-center content-center h-100 text-center\"\n\t\t\tclass:over={stage == \"over\"}>\n\t\t\t{#if stage == \"over\"}\n\t\t\t\t<div>\n\t\t\t\t\t<div class=\"empty-icon\">\n\t\t\t\t\t\t<i class=\"fas fa-smile-wink fa-3x\" />\n\t\t\t\t\t</div>\n\t\t\t\t\t<p class=\"text-xl\">{$_(\"drop-a-book-folder-here\")}</p>\n\t\t\t\t</div>\n\t\t\t{:else if stage == \"waiting\"}\n\t\t\t\t<div>\n\t\t\t\t\t<div class=\"empty-icon\">\n\t\t\t\t\t\t<i class=\"fas fa-book fa-3x\" />\n\t\t\t\t\t</div>\n\t\t\t\t\t<p class=\"text-xl\">{$_(\"no_book\")}</p>\n\t\t\t\t\t<p class=\"text-light\">{$_(\"drag-and-drop-to-start\")}</p>\n\t\t\t\t\t<div class=\"mt-6\">\n\t\t\t\t\t\t<a class=\"btn btn-blue\" href=\"/documentation/getting-started\">\n\t\t\t\t\t\t\t{@html $_(\"learn-more-long\")}\n\t\t\t\t\t\t</a>\n\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"mt-6\">\n\t\t\t\t\t\t\t<span class=\"btn btn-blue\" on:click={loadFiles}>\n\t\t\t\t\t\t\t\t<input type=\"file\" class=\"hidden\" id=\"file-input\" webkitdirectory multiple directory on:change={filesLoaded}>\n\t\t\t\t\t\t\t\t{@html $_(\"load-folder\")}\n\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t{:else if stage == \"loading\"}\n\t\t\t\t<div>\n\t\t\t\t\t<div class=\"empty-icon\">\n\t\t\t\t\t\t<i class=\"fas fa-spinner fa-3x fa-spin\" />\n\t\t\t\t\t</div>\n\t\t\t\t\t<p class=\"text-xl\">{$_(\"loading\")}</p>\n\t\t\t\t\t<p class=\"text-light\">{msg}</p>\n\t\t\t\t</div>\n\t\t\t{/if}\n\t\t</div>\n\t{:else}\n\t\t<Tabs {book} />\n\t\t<TabsActions\n\t\t\ton:generateBook={actionGenerateBook}\n\t\t\ton:generateSite={actionGenerateSite} />\n\t{/if}\n</div>\n"
  ],
  "names": [],
  "mappings": "AAuGC,KAAK,eAAC,CAAC,AACN,MAAM,CAAE,KAAK,CAAC,GAAG,CAAC,OAAO,AAC1B,CAAC,AAED,YAAY,eAAC,CAAC,AACb,MAAM,CAAE,KAAK,KAAK,CAAC,CAAC,CAAC,IAAI,CAAC,AAC3B,CAAC"
}